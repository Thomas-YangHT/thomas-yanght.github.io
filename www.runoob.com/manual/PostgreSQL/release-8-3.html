<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML><HEAD><TITLE>发布8.3</TITLE><META NAME="GENERATOR" CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK REV="MADE" HREF="mailto:pgsql-docs@postgresql.org"><LINK REL="HOME" TITLE="PostgreSQL 9.3.1 中文手册" HREF="http://school.yunwei.edu/manual/PostgreSQL/index.html"><LINK REL="UP" TITLE="版本说明" HREF="http://school.yunwei.edu/manual/PostgreSQL/release.html"><LINK REL="PREVIOUS" TITLE="发布8.3.1" HREF="release-8-3-1.html"><LINK REL="NEXT" TITLE="版本 8.2.23" HREF="release-8-2-23.html"><LINK REL="STYLESHEET" TYPE="text/css" HREF="http://school.yunwei.edu/manual/PostgreSQL/stylesheet.css"><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8"><META NAME="creation" CONTENT="2015-07-11T14:00:17"></HEAD><BODY CLASS="SECT1">
<div style="text-align:right">
<a style="margin : 0px 0px 0px 10px;" href="https://github.com/postgres-cn/pgdoc-cn/issues/new" target="_blank" title="在Github上报告问题（请注明问题内容及所在章节）">问题报告</a>
<a style="margin : 0px 0px 0px 10px;" href="https://github.com/postgres-cn/pgdoc-cn/edit/master/postgresql/doc/src/sgml/release-8.3.sgml" target="_blank" title="直接在Github上纠错本页面">纠错本页面</a>
</div>
<DIV CLASS="NAVHEADER"><TABLE SUMMARY="Header navigation table" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0"><TR><TH COLSPAN="5" ALIGN="center" VALIGN="bottom"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/index.html">PostgreSQL 9.3.1 中文手册</A></TH></TR><TR><TD WIDTH="10%" ALIGN="left" VALIGN="top"><A TITLE="发布8.3.1" HREF="release-8-3-1.html" ACCESSKEY="P">&#19978;&#19968;&#39029;</A></TD><TD WIDTH="10%" ALIGN="left" VALIGN="top"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/release.html" ACCESSKEY="U">&#19978;&#19968;&#32423;</A></TD><TD WIDTH="60%" ALIGN="center" VALIGN="bottom">&#38468;&#24405; E. 版本说明</TD><TD WIDTH="20%" ALIGN="right" VALIGN="top"><A TITLE="版本 8.2.23" HREF="release-8-2-23.html" ACCESSKEY="N">&#19979;&#19968;&#39029;</A></TD></TR></TABLE><HR ALIGN="LEFT" WIDTH="100%"></DIV><DIV CLASS="SECT1"><H1 CLASS="SECT1"><A NAME="RELEASE-8-3">E.77. 发布8.3</A></H1><DIV CLASS="NOTE"><BLOCKQUOTE CLASS="NOTE"><P><B>发布日期: </B>2008-02-04</P></BLOCKQUOTE></DIV><DIV CLASS="SECT2"><H2 CLASS="SECT2"><A NAME="AEN129247">E.77.1. 概述</A></H2><P> 随着显著的新功能和性能增强，此版本对于<SPAN CLASS="PRODUCTNAME">PostgreSQL</SPAN>是一个重大的飞跃。
通过越来越多的社区已经大大加快了发展的步伐成为可能。此版本增加了以下主要特性：</P><P></P><UL><LI><P> 全文搜索被集合到核心数据库系统中</P></LI><LI><P> 支持SQL/XML标准，包含新的操作以及<TT CLASS="TYPE">XML</TT>数据类型</P></LI><LI><P> 枚举数据类型(<TT CLASS="TYPE">ENUM</TT>) </P></LI><LI><P> 复合类型数组</P></LI><LI><P> 通用唯一标识符(<TT CLASS="TYPE">UUID</TT>)数据类型 </P></LI><LI><P> 添加控制是否<TT CLASS="LITERAL">NULL</TT>首先排序还是最后排序</P></LI><LI><P> 可更新游标</P></LI><LI><P> 服务器配置参数可以基于每个函数被设置 </P></LI><LI><P> 用户定义类型可以有类型修饰符</P></LI><LI><P> 当更新表定义变化或者统计的时候，自动重新规划缓存查询</P></LI><LI><P> 记录和统计收集中大量优化</P></LI><LI><P> 为Windows上认证支持安全服务提供者接口(<ACRONYM CLASS="ACRONYM">SSPI</ACRONYM>)</P></LI><LI><P> 支持多个并发autovacuum进程，和其它autovacuum优化</P></LI><LI><P> 允许使用<SPAN CLASS="PRODUCTNAME">Microsoft Visual C++</SPAN>编译整个<SPAN CLASS="PRODUCTNAME">PostgreSQL</SPAN>发布</P></LI></UL><P> 主要性能改进如下。大部分这些功能是自动的，不需要用户改变或者调整：</P><P></P><UL><LI><P> 在事务提交期间异步提交延迟写入WAL</P></LI><LI><P> 检查点写操作被分散在一个较长时间周期内用来平滑每个检查点中I/O剧增</P></LI><LI><P> 堆元组(<ACRONYM CLASS="ACRONYM">HOT</ACRONYM>)加快了大部分<TT CLASS="COMMAND">UPDATE</TT>和<TT CLASS="COMMAND">DELETE</TT>的
空间复用 </P></LI><LI><P> 及时后端写策略提高了磁盘写效率 </P></LI><LI><P> 为只读事务使用非持久事务ID减少开销和<TT CLASS="COMMAND">VACUUM</TT>需求</P></LI><LI><P> 减少每个字段和每行存储开销</P></LI><LI><P> 大顺序扫描不再频繁删除已使用缓存页</P></LI><LI><P> 并发大顺序扫描可以共享磁盘读取</P></LI><LI><P> <TT CLASS="LITERAL">ORDER BY ... LIMIT</TT>无需排序</P></LI></UL><P> 在下面章节更详细解释了上面每一项。</P></DIV><DIV CLASS="SECT2"><H2 CLASS="SECT2"><A NAME="AEN129313">E.77.2. 迁移到版本8.3</A></H2><P> 使用<SPAN CLASS="APPLICATION">pg_dump</SPAN>的备份/恢复为了那些希望从任何其它版本
迁移数据。</P><P> 观察下面的不兼容性：</P><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN129318">E.77.2.1. 普遍的</A></H3><P></P><UL><LI><P> 非字符数据类型不再自动转换为<TT CLASS="TYPE">TEXT</TT> (Peter, Tom)</P><P>
之前，如果一个非字符值被提供给要求<TT CLASS="TYPE">text</TT>输入的操作者或函数，
它会自动转换为<TT CLASS="TYPE">text</TT>，针对大多数（但不是全部）内置的数据类型。
这不再发生：为了所有非字符串类型需要显式转换为<TT CLASS="TYPE">text</TT>。例如，这些
表达式曾执行：
</P><PRE CLASS="PROGRAMLISTING">substr(current_date, 1, 4)
23 LIKE '2%'</PRE><P>
但是现在分别导致 <SPAN CLASS="QUOTE">"函数不存在"</SPAN>和<SPAN CLASS="QUOTE">"操作符不存在"</SPAN>错误。
使用显式转换而不是：
</P><PRE CLASS="PROGRAMLISTING">substr(current_date::text, 1, 4)
23::text LIKE '2%'</PRE><P>
（当然，你也可以使用更详细的<TT CLASS="LITERAL">CAST()</TT>语法了。）
该变化的原因是这些自动强制转换过于频繁引起令人惊讶操作。
一个例子是在以前的版本中，接受这个表达式，但并没有执行预期的内容：
</P><PRE CLASS="PROGRAMLISTING">current_date &lt; 2017-11-17</PRE><P>
这实际上比较日期为整数，这应该被（现在是）拒绝&mdash;
但双方自动转换都被转换为<TT CLASS="TYPE">text</TT>并且执行文本比较，
因为当没有其他的<TT CLASS="LITERAL">&lt;</TT>操作符的时候，
<TT CLASS="LITERAL">text &lt; text</TT>操作符可以匹配表达式。
</P><P> 类型<TT CLASS="TYPE">char(<TT CLASS="REPLACEABLE"><I>n</I></TT>)</TT>和
<TT CLASS="TYPE">varchar(<TT CLASS="REPLACEABLE"><I>n</I></TT>)</TT>仍然自动转换为<TT CLASS="TYPE">text</TT>。
另外，自动转换到<TT CLASS="TYPE">text</TT>仍然为输入级联(<TT CLASS="LITERAL">||</TT>)操作符执行，
只要至少一个输入是字符串类型。</P></LI><LI><P> 来自<TT CLASS="FILENAME">contrib/tsearch2</TT>全文搜索特性已经被移动到核心服务器中，有一些小的语法变化</P><P> <TT CLASS="FILENAME">contrib/tsearch2</TT>包含一个兼容接口。</P></LI><LI><P> <TT CLASS="LITERAL">ARRAY(SELECT ...)</TT>，其中<TT CLASS="COMMAND">SELECT</TT>没有返回行，现在返回
一个空数组，而不是NULL(Tom)</P></LI><LI><P> 基本数据类型的数组类型名不再是带有下划线前缀的基础类型名</P><P> 当有可能时，旧的命名约定仍然采用，
但应用程序代码不应该再依赖于它。
代替使用新的<TT CLASS="LITERAL">pg_type.typarray</TT>列，
以确定与给定的类型相关联的数组数据类型。</P></LI><LI><P> <TT CLASS="LITERAL">ORDER BY ... USING</TT> <TT CLASS="REPLACEABLE"><I>operator</I></TT>必须使用小于或者大于在btree操作符类中
定义的<TT CLASS="REPLACEABLE"><I>operator</I></TT></P><P> 为防止不一致结果添加该限制。</P></LI><LI><P> <TT CLASS="COMMAND">SET LOCAL</TT>变化持续直到最外层事务截止，除非回滚(Tom)</P><P> 之前在子事务提交后（<TT CLASS="COMMAND">RELEASE SAVEPOINT</TT>或者从PL/pgSQL异常块中退出）
丢失<TT CLASS="COMMAND">SET LOCAL</TT>的影响</P></LI><LI><P> 在事务块中拒绝的命令在多语句查询字符串中被拒绝(Tom)</P><P> 比如，<TT CLASS="LITERAL">"BEGIN; DROP DATABASE; COMMIT"</TT>被拒绝即使作为单一查询消息被提交。</P></LI><LI><P> 事务块外部<TT CLASS="COMMAND">ROLLBACK</TT>发出<TT CLASS="LITERAL">NOTICE</TT>而不是<TT CLASS="LITERAL">WARNING</TT> (Bruce)</P></LI><LI><P> 阻止<TT CLASS="COMMAND">NOTIFY</TT>/<TT CLASS="COMMAND">LISTEN</TT>/<TT CLASS="COMMAND">UNLISTEN</TT>接受
模式限定名称(Bruce)</P><P> 之前，这些命令接受<TT CLASS="LITERAL">schema.relation</TT>但是忽略模式部分，这是令人困惑的。</P></LI><LI><P> <TT CLASS="COMMAND">ALTER SEQUENCE</TT>不再影响序列的<CODE CLASS="FUNCTION">currval()</CODE>状态(Tom)</P></LI><LI><P> 外键必须匹配交叉数据类型引用的可索引条件(Tom)</P><P> 这改善了语义一致性并且可以避免性能问题。</P></LI><LI><P> 限制对象大小函数到拥有合理权限可以查看该信息的用户(Tom) </P><P> 比如，<CODE CLASS="FUNCTION">pg_database_size()</CODE>需要<TT CLASS="LITERAL">CONNECT</TT>权限，
这缺省授权给每一个人。<CODE CLASS="FUNCTION">pg_tablespace_size()</CODE>在表空间上需要
<TT CLASS="LITERAL">CREATE</TT>权限，如果表空间是数据库缺省表空间，则允许。</P></LI><LI><P> 删除非法的<TT CLASS="LITERAL">!!=</TT> (非in)操作符(Tom)</P><P> <TT CLASS="LITERAL">NOT IN (SELECT ...)</TT>是执行该操作的正确方式。</P></LI><LI><P> 内部哈希函数更加一致分布(Tom)</P><P> 如果应用程序代码正使用内部<SPAN CLASS="PRODUCTNAME">PostgreSQL</SPAN>哈希函数计算并且存储哈希值，
那么哈希值必须被再生。</P></LI><LI><P> 改变处理可变长度数据值C代码约定(Greg Stark, Tom) </P><P> 新的<CODE CLASS="FUNCTION">SET_VARSIZE()</CODE>宏<SPAN CLASS="emphasis"><I CLASS="EMPHASIS">必须</I></SPAN>用于设置生成<TT CLASS="TYPE">varlena</TT>值的长度。
另外，它在更多情况中有必要扩展(<SPAN CLASS="QUOTE">"de-TOAST"</SPAN>)的输入值。</P></LI><LI><P> 连续归档不再报告每个成功归档操作到服务器日志，除非使用<TT CLASS="LITERAL">DEBUG</TT>级别(Simon) </P></LI></UL></DIV><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN129419">E.77.2.2. 配置参数</A></H3><P></P><UL><LI><P> 管理服务器参数中许多变化</P><P> 删除<TT CLASS="VARNAME">bgwriter_lru_percent</TT>,
<TT CLASS="VARNAME">bgwriter_all_percent</TT>,
<TT CLASS="VARNAME">bgwriter_all_maxpages</TT>,
<TT CLASS="VARNAME">stats_start_collector</TT>和
<TT CLASS="VARNAME">stats_reset_on_server_start</TT>。
<TT CLASS="VARNAME">redirect_stderr</TT>重命名为
<TT CLASS="VARNAME">logging_collector</TT>。
<TT CLASS="VARNAME">stats_command_string</TT>重命名为
<TT CLASS="VARNAME">track_activities</TT>。
<TT CLASS="VARNAME">stats_block_level</TT>和<TT CLASS="VARNAME">stats_row_level</TT>
被合并为<TT CLASS="VARNAME">track_counts</TT>。
一个新的布尔配置参数<TT CLASS="VARNAME">archive_mode</TT>控制归档。Autovacuum的缺省设置已改变。</P></LI><LI><P> 删除<TT CLASS="VARNAME">stats_start_collector</TT>参数(Tom)</P><P> 我们现在总是启动收集器处理过程，除非<ACRONYM CLASS="ACRONYM">UDP</ACRONYM>套接创建失败。</P></LI><LI><P> 删除<TT CLASS="VARNAME">stats_reset_on_server_start</TT>参数(Tom)</P><P> 这被删除，因为<CODE CLASS="FUNCTION">pg_stat_reset()</CODE>用于这一目的。</P></LI><LI><P> <TT CLASS="FILENAME">postgresql.conf</TT>中注释参数导致它恢复到缺省值(Joachim Wieland) </P><P> 之前，注释项留下参数的值未改变直到下次服务器重新启动。</P></LI></UL></DIV><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN129452">E.77.2.3. 字符编码</A></H3><P></P><UL><LI><P> 添加对无效编码数据的更多检查(Andrew)</P><P> 该变化插入反斜杠转义字符串处理和<TT CLASS="COMMAND">COPY</TT>转义处理中存在的一些漏洞。
目前检查脱转义字符串看是否其结果创建了一个无效的多字节字符。</P></LI><LI><P> 不允许与服务器的区域设置不一致的数据库编码(Tom)</P><P> 在大多数平台上，<TT CLASS="LITERAL">C</TT>区域是与任何数据库编码执行的唯一区域。
其它区域设置说明了一个特定的编码，并且如果数据库编码不同，则错误操作（典型的症状包括虚假文本
排序顺序和来自<CODE CLASS="FUNCTION">upper()</CODE>或者<CODE CLASS="FUNCTION">lower()</CODE>的错误结果）
现在服务器拒绝尝试创建有一个不兼容编码的数据库。</P></LI><LI><P> 确保<CODE CLASS="FUNCTION">chr()</CODE>不能创建无效编码值(Andrew)</P><P> 在UTF8编码数据库中<CODE CLASS="FUNCTION">chr()</CODE>参数被认为Unicode代码点。
在其它多字节编码中<CODE CLASS="FUNCTION">chr()</CODE>的参数必须指定7位ASCII字符。
不再接受零。调整<CODE CLASS="FUNCTION">ascii()</CODE>以达到匹配。</P></LI><LI><P> 调整<CODE CLASS="FUNCTION">convert()</CODE>操作用来确保编码有效性(Andrew)</P><P> <CODE CLASS="FUNCTION">convert()</CODE>的两个参数形式已被删除。
这三个参数的形式现在需要<TT CLASS="TYPE">bytea</TT>第一个参数，并返回一个<TT CLASS="TYPE">bytea</TT>。
为了代替函数缺失，三个新的函数被添加：</P><P></P><UL><LI><P> <CODE CLASS="FUNCTION">convert_from(bytea, name)</CODE>返回<TT CLASS="TYPE">text</TT> &mdash;
从指定编码的第一个参数转化到数据库编码</P></LI><LI><P> <CODE CLASS="FUNCTION">convert_to(text, name)</CODE>返回<TT CLASS="TYPE">bytea</TT> &mdash;；
转换数据库编码的第一个参数到指定编码</P></LI><LI><P> <CODE CLASS="FUNCTION">length(bytea, name)</CODE>返回<TT CLASS="TYPE">integer</TT> &mdash;
给定指定编码字符中第一个参数长度
</P></LI></UL></LI><LI><P> 删除<TT CLASS="LITERAL">转换(参数使用conversion_name)</TT>
(Andrew)</P><P> 其操作不符合SQL标准。</P></LI><LI><P> 客户端JOHAB编码(Tatsuo)</P><P> JOHAB作为服务器端编码不安全。</P></LI></UL></DIV></DIV><DIV CLASS="SECT2"><H2 CLASS="SECT2"><A NAME="AEN129499">E.77.3. 变化</A></H2><P> 下面你将发现在<SPAN CLASS="PRODUCTNAME">PostgreSQL</SPAN> 8.3和之前主要发布版本之间变化的详细说明。</P><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN129503">E.77.3.1. 性能</A></H3><P></P><UL><LI><P> 在事务提交期间异步提交延迟写入WAL(Simon)</P><P> 此功能极大地提高了短期数据修改事务性能。
缺点是由于磁盘写入延迟，
如果数据被写入到磁盘之前该数据库或操作系统崩溃，
那么提交的数据将会丢失。此功能对可以接受一些数据丢失的应用程序是有益处的。
不像关闭<TT CLASS="VARNAME">fsync</TT>，
使用异步提交不会把数据库一致性放在危险的处境中;
最坏的情况是崩溃后最后几个据称已提交的事务可能不会被提交。
此功能通过关闭<TT CLASS="VARNAME">synchronous_commit</TT>被启用
（由每个会话或每个事务来完成，如果一些事务是关键的，而另一些则不是）。
<TT CLASS="VARNAME">wal_writer_delay</TT>在事务实际到达磁盘之前可以被调整以控制最大延迟。&#13;</P></LI><LI><P> 检查点写操作被分散在一个较长时间周期内用来平滑每个检查点中I/O剧增
(Itagaki Takahiro和Heikki Linnakangas)</P><P> 以前所有修改过的缓冲区在检查点期间尽可能快地被强制到磁盘中，
造成I/O剧增，降低服务器的性能。
这种新方法在检查点中向外扩散到磁盘写入，
降低最大I/O使用。（尽可能快的写入用户请求和关闭检查点）。&#13;</P></LI><LI><P> 堆元组（<ACRONYM CLASS="ACRONYM">HOT</ACRONYM>）为<TT CLASS="COMMAND">UPDATE</TT>和<TT CLASS="COMMAND">DELETE</TT>
加速空间再利用(Pavan Deolasee, 还有许多其他的想法)</P><P> <TT CLASS="COMMAND">UPDATE</TT>和<TT CLASS="COMMAND">DELETE</TT>舍弃死元组，
因为执行失败的<TT CLASS="COMMAND">INSERT</TT>。之前仅仅
<TT CLASS="COMMAND">VACUUM</TT>可以回收通过死元组采取的空间。
如果没有变化到索引列，那么在<TT CLASS="COMMAND">INSERT</TT>或者<TT CLASS="COMMAND">UPDATE</TT>的时候<ACRONYM CLASS="ACRONYM">HOT</ACRONYM>死元组空间可以被自动回收。
这允许更加一致的性能。此外，<ACRONYM CLASS="ACRONYM">HOT</ACRONYM>避免添加重复索引项。 </P></LI><LI><P> 实时后台写策略提高磁盘写入效率(Greg Smith, Itagaki Takahiro)</P><P> 这极大降低了后台写入的手动调整需要。</P></LI><LI><P> 降低每个字段和每行存储开销(Greg Stark, Heikki Linnakangas)</P><P> 数据值小于128字节的可变长度数据类型将看到3至6个字节的存储减少。
例如，两个相邻的<TT CLASS="TYPE">char(1)</TT>字段现在使用4个字节，而不是16。
行标头是比以前更短的4个字节。</P></LI><LI><P> 为只读事务使用非持久事务ID减少开销和<TT CLASS="COMMAND">VACUUM</TT>需求(Florian Pflug)</P><P> 非持久性事务ID不会增加全局事务计数器。因此，它能减少<TT CLASS="STRUCTNAME">pg_clog</TT>上负载
并且增加强制vacuum以防止事务ID重叠期间的时间。
采取的其它性能改进提高了并发性。</P></LI><LI><P> 在只读命令后避免增加命令计数器(Tom) </P><P> 之前每个事务2<SUP>32</SUP>(4十亿)命令的硬性限制。
现在唯一的命令实际上改变了数据库计数，
因此，虽然这一限制仍然存在，它应该很少令人讨厌。</P></LI><LI><P> 创建专用<ACRONYM CLASS="ACRONYM">WAL</ACRONYM>写进程从后台卸载操作(Simon)</P></LI><LI><P> 为<TT CLASS="COMMAND">CLUSTER</TT>和<TT CLASS="COMMAND">COPY</TT>忽略不必要的WAL写进程(Simon)</P><P> 除非启用WAL归档，那么在命令结尾为<TT CLASS="COMMAND">CLUSTER</TT>和<CODE CLASS="FUNCTION">fsync()</CODE>表系统避免WAL写操作。
如果在同一个事务中创建该表，那么与<TT CLASS="COMMAND">COPY</TT>是一样的。&#13;</P></LI><LI><P> 大顺序扫描不再频繁删除已使用缓存页(Simon, Heikki, Tom)</P></LI><LI><P> 并发大顺序扫描可以共享磁盘读取(Jeff Davis)</P><P> 通过在表的中间开始新的顺序扫描被完成
（其中另一个顺序扫描在进行中），并返回开始以完成。
这会影响没有指定<TT CLASS="LITERAL">ORDER BY</TT>的查询中返回行的顺序。
如果有必要的话，<TT CLASS="VARNAME">synchronize_seqscans</TT>配置参数可以用来禁用它。 </P></LI><LI><P> <TT CLASS="LITERAL">ORDER BY ... LIMIT</TT>无需排序(Greg Stark)</P><P> 这是通过顺序扫描表并且跟踪<SPAN CLASS="QUOTE">"top N"</SPAN>候选行执行，
而非执行全排序整个表。
当没有匹配索引并且<TT CLASS="LITERAL">LIMIT</TT>不大的时候，这是很有用的。&#13;</P></LI><LI><P> 将信息上速度限制发送到后台统计收集器上(Tom)</P><P> 这降低了短事务开销，但是可能有时在统计之前增加延迟。</P></LI><LI><P> 完善许多空值情况下哈希连接性能(Tom)</P></LI><LI><P> 加快非精确数据类型匹配操作符查找情况(Tom) </P></LI></UL></DIV><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN129576">E.77.3.2. 服务器</A></H3><P></P><UL><LI><P> 缺省启用Autovacuum (Alvaro)</P><P> 进行了几处修改以消除启用自动清理的缺点，
从而证明缺省变化。一些其他自动清理参数缺省也被修改。</P></LI><LI><P> 支持多个并发自动清理进程(Alvaro, Itagaki Takahiro)</P><P> 这允许同时运行多个清理。这可以阻止大表清理延迟小表清理。 </P></LI><LI><P> 当表定义变化或者统计被更新的时候，自动重新规划缓存查询(Tom)</P><P> 如果临时表在函数调用之间被删除并且重新创建，
之前引用临时表的PL/pgSQL函数可能会失败，
除非使用<TT CLASS="LITERAL">EXECUTE</TT>。
这个改进解决了该问题和许多相关的问题。</P></LI><LI><P> 添加<TT CLASS="VARNAME">temp_tablespaces</TT>参数
以控制临时表和文件的表空间(Jaime Casanova,Albert Cervera, Bernd Helmle) </P><P> 该参数定义了要使用的表空间列表。
启用在多个表空间上分散I/O负载。
随机表空间在创建一个临时对象时被选择。
临时文件不再存储在每个数据库<TT CLASS="FILENAME">pgsql_tmp/</TT>目录中，
而在每个表空间目录中。&#13;</P></LI><LI><P> 将临时表的TOAST表放在<TT CLASS="LITERAL">pg_toast_temp_<TT CLASS="REPLACEABLE"><I>nnn</I></TT></TT>命名的特殊模式中(Tom)</P><P> 这使得低级别的代码将这些表看作临时的，
这可以启动各种优化比如没有WAL日志记录更改
并且使用本地而不是共享缓存的访问。这也修复了一个错误，
其中后端意外保持打开的文件引用到临时TOAST表。 </P></LI><LI><P> 修复新连接请求恒流可能无限延迟postmaster完成关机或者死机重启的问题(Tom)</P></LI><LI><P> 警惕非常低概率的数据丢失情况，防止
重新使用已删除表的relfilenode，直到下一个检查点之后(Heikki)</P></LI><LI><P> 修复<TT CLASS="COMMAND">CREATE CONSTRAINT TRIGGER</TT>用来转换旧形式外键触发器定义
到规则外键约束(Tom)</P><P> 这将缓解来自7.3之前数据库外键约束移植，如果它们从来没使用<TT CLASS="FILENAME">contrib/adddepend</TT>被转移。</P></LI><LI><P> 修复<TT CLASS="LITERAL">DEFAULT NULL</TT>重写继承的缺省值(Tom)</P><P> <TT CLASS="LITERAL">DEFAULT NULL</TT>之前被认为噪声短语，但是它应该（并且现在）覆盖非零缺省
否则从父表或者域中被继承。</P></LI><LI><P>
添加新的编码EUC_JIS_2004和SHIFT_JIS_2004 (Tatsuo)</P><P> 这些新编码可以从UTF-8被转换。</P></LI><LI><P> 从<SPAN CLASS="QUOTE">"数据库系统准备就绪"</SPAN>到<SPAN CLASS="QUOTE">"数据库系统准备接受连接"</SPAN>
改变服务器启动日志信息，并且调整其定时</P><P> 仅仅当postmaster准备好接受连接的时候出现该信息。</P></LI></UL></DIV><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN129621">E.77.3.3. 监控</A></H3><P></P><UL><LI><P> 添加<TT CLASS="VARNAME">log_autovacuum_min_duration</TT>参数以支持autovacuum活动可配置记录(Simon, Alvaro)</P></LI><LI><P> 添加<TT CLASS="VARNAME">log_lock_waits</TT>记录锁等待(Simon)</P></LI><LI><P> 添加<TT CLASS="VARNAME">log_temp_files</TT>记录临时文件用法(Bill Moran)</P></LI><LI><P> 添加<TT CLASS="VARNAME">log_checkpoints</TT>参数完善检查点记录(Greg Smith, Heikki)</P></LI><LI><P> <TT CLASS="VARNAME">log_line_prefix</TT>目前支持所有过程中
<TT CLASS="LITERAL">%s</TT>和<TT CLASS="LITERAL">%c</TT>转义(Andrew)</P><P> 之前这些转义只用于用户会话中，而不是后台数据库过程。</P></LI><LI><P> 添加<TT CLASS="VARNAME">log_restartpoints</TT>控制即时恢复重启点记录(Simon)</P></LI><LI><P> 最后事务结束时间被记录到恢复结束和每个记录重启点(Simon)</P></LI><LI><P> Autovacuum报告<TT CLASS="LITERAL">pg_stat_activity</TT>中活动启动时间(Tom)</P></LI><LI><P> 允许逗号分隔值（CSV）形式的服务器日志输出(Arul Shaji, Greg Smith, Andrew Dunstan)</P><P> CSV格式日志文件可以很容易为后续分析被加载到数据库表中。</P></LI><LI><P> 使用PostgreSQL提供的时区支持服务器日志中显示的格式时间戳(Tom) </P><P> 这避免了提供错误编码中本地化时区名称Windows特定问题。
有一个新的<TT CLASS="VARNAME">log_timezone</TT>参数控制用于日志消息中的时区，
独立于客户端可见<TT CLASS="VARNAME">timezone</TT>参数。</P></LI><LI><P> 新系统视图<TT CLASS="LITERAL">pg_stat_bgwriter</TT>显示关于后台写活动统计(Magnus)</P></LI><LI><P> 为数据库端元组统计添加新列到<TT CLASS="LITERAL">pg_stat_database</TT> (Magnus)</P></LI><LI><P> 添加<TT CLASS="LITERAL">xact_start</TT> (事务启动时间)列到
<TT CLASS="LITERAL">pg_stat_activity</TT> (Neil)</P><P> 这使得很容易识别长期存在的事务。 </P></LI><LI><P> 添加<TT CLASS="LITERAL">n_live_tuples</TT>和<TT CLASS="LITERAL">n_dead_tuples</TT>列到
<TT CLASS="LITERAL">pg_stat_all_tables</TT>和相关视图中(Glen Parker)</P></LI><LI><P> 合并<TT CLASS="VARNAME">stats_block_level</TT>和<TT CLASS="VARNAME">stats_row_level</TT>
参数到单一参数<TT CLASS="VARNAME">track_counts</TT>，这控制着发送到统计收集器过程的所有信息(Tom)</P></LI><LI><P> 重命名<TT CLASS="VARNAME">stats_command_string</TT>参数为
<TT CLASS="VARNAME">track_activities</TT> (Tom)</P></LI><LI><P> 修复活的和死的元组统计计数以意识到已提交的和终止的事务有不同效果(Tom)</P></LI></UL></DIV><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN129685">E.77.3.4. 认证</A></H3><P></P><UL><LI><P> 为Windows上认证支持安全服务提供者接口(<ACRONYM CLASS="ACRONYM">SSPI</ACRONYM>) (Magnus)</P></LI><LI><P> 支持GSSAPI 认证(Henry Hotz, Magnus)</P><P> 这是首先的本地Kerberos认证，因为GSSAPI是行业标准。</P></LI><LI><P> 支持全球SSL配置文件(Victor Wagner)</P></LI><LI><P> 添加<TT CLASS="VARNAME">ssl_ciphers</TT>参数控制可接受SSL加密(Victor Wagner)</P></LI><LI><P> 添加Kerberos范围参数，<TT CLASS="VARNAME">krb_realm</TT> (Magnus)</P></LI></UL></DIV><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN129702">E.77.3.5. 预写日志(<ACRONYM CLASS="ACRONYM">WAL</ACRONYM>)和连续归档</A></H3><P></P><UL><LI><P> 改变来自time_t到TimestampTz表示形式的事务WAL记录中的时间戳记录(Tom)</P><P> 在WAL中提供了列居第二位解决方法。这对于点即时恢复有益处。 </P></LI><LI><P> 减少热备份服务器需要的WAL磁盘空间(Simon) </P><P> 这种变化允许热备用服务器传递最早仍然需要WAL文件名字到恢复脚本，
允许不再需要的WAL文件自动清除。
使用<TT CLASS="FILENAME">recovery.conf</TT>中<TT CLASS="VARNAME">restore_command</TT>参数
<TT CLASS="LITERAL">%r</TT>的执行。</P></LI><LI><P> 新的布尔配置参数，<TT CLASS="VARNAME">archive_mode</TT>，控制归档(Simon)</P><P> 之前设置<TT CLASS="VARNAME">archive_command</TT>为空字符串关闭归档。现在<TT CLASS="VARNAME">archive_mode</TT>
使归档开启和关闭，独立于<TT CLASS="VARNAME">archive_command</TT>。
这用于暂时停止归档。</P></LI></UL></DIV><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN129722">E.77.3.6. 查询</A></H3><P></P><UL><LI><P> 全文搜索被集合到核心数据库系统中(Teodor, Oleg)</P><P> 文本搜索已被改进，移动到核心代码中，并且缺省安装。
<TT CLASS="FILENAME">contrib/tsearch2</TT>包含兼容接口。</P></LI><LI><P> 添加控制是否<TT CLASS="LITERAL">NULL</TT>首先排序还是最后排序(Teodor, Tom)</P><P> 语法是<TT CLASS="LITERAL">ORDER BY ... NULLS FIRST/LAST</TT>。</P></LI><LI><P> 允许每列升序/降序（<TT CLASS="LITERAL">ASC</TT>/<TT CLASS="LITERAL">DESC</TT>）索引排序选项(Teodor, Tom)</P><P> 之前使用带有混合<TT CLASS="LITERAL">ASC</TT>/<TT CLASS="LITERAL">DESC</TT>说明符<TT CLASS="LITERAL">ORDER BY</TT>的查询
不能完全使用索引。如果使用匹配的<TT CLASS="LITERAL">ASC</TT>/<TT CLASS="LITERAL">DESC</TT>说明符创建索引，
那么现在在这种情况中可以完全使用索引。可以控制索引中<TT CLASS="LITERAL">NULL</TT>排序顺序。
</P></LI><LI><P> 允许<TT CLASS="LITERAL">col IS NULL</TT>使用索引(Teodor)</P></LI><LI><P> 可更新游标(Arul Shaji, Tom)</P><P> 这消除了参考主键到游标返回的<TT CLASS="COMMAND">UPDATE</TT>或者<TT CLASS="COMMAND">DELETE</TT>行的需要。
语法为<TT CLASS="LITERAL">UPDATE/DELETE WHERE CURRENT OF</TT>。</P></LI><LI><P> 允许游标中<TT CLASS="LITERAL">FOR UPDATE</TT> (Arul Shaji, Tom)</P></LI><LI><P> 创建通用机制为<SPAN CLASS="emphasis"><I CLASS="EMPHASIS">每个</I></SPAN>数据类型支持来自标准字符串类型(<TT CLASS="TYPE">TEXT</TT>, <TT CLASS="TYPE">VARCHAR</TT>,
<TT CLASS="TYPE">CHAR</TT>)转换，通过调用数据类型的I/O函数(Tom)</P><P> 之前，这样的转换只适用于此目的具有专门函数的类型。
这些新的类型转换只在字符串方向被分配，显式仅在其他方向，
因此应该创建不令人惊讶的操作。&#13;</P></LI><LI><P> 当所有输入是域类型时，允许<TT CLASS="LITERAL">UNION</TT>和相关结构返回域类型(Tom)</P><P> 之前，输出可能被认为是域的基本类型。</P></LI><LI><P> 当使用两种不同数据类型的时候，允许有限的散列(Tom)</P><P> 这允许哈希连接，哈希索引，散列子规划，以及
在涉及跨数据类型比较的情况下使用的散列聚合，
如果该数据类型具有兼容的散列函数。
目前，跨数据类型散列支持存在于<TT CLASS="TYPE">smallint</TT>/<TT CLASS="TYPE">integer</TT>/<TT CLASS="TYPE">bigint</TT>,
以及<TT CLASS="TYPE">float4</TT>/<TT CLASS="TYPE">float8</TT>中。&#13;</P></LI><LI><P> 当<TT CLASS="LITERAL">WHERE</TT>子句中变量相等时，改善优化逻辑检测(Tom)</P><P> 这允许降序排序顺序合并连接，并且改进识别冗余排序列。</P></LI><LI><P> 在大多数表通过约束被排除的情况下规划大继承树时，提高性能(Tom)</P></LI></UL></DIV><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN129782">E.77.3.7. 对象操作</A></H3><P></P><UL><LI><P> 复合类型数组(David Fetter, Andrew, Tom)</P><P> 除了显式声明的复合类型的数组外，
目前支持常规表和视图行类型数组，除了系统目录行类型，序列和TOAST表。</P></LI><LI><P> 每个函数基础上设置服务器配置参数(Tom) </P><P> 比如，如果在运行时存在不同的<TT CLASS="VARNAME">search_path</TT>，函数可以设置自身的<TT CLASS="VARNAME">search_path</TT>
避免意外操作。安全定义函数可以设置<TT CLASS="VARNAME">search_path</TT>以避免安全漏洞。</P></LI><LI><P> <TT CLASS="COMMAND">CREATE/ALTER FUNCTION</TT>现在可以支持
<TT CLASS="LITERAL">COST</TT>和<TT CLASS="LITERAL">ROWS</TT>选项(Tom)</P><P> <TT CLASS="LITERAL">COST</TT>允许函数调用成本的说明。
<TT CLASS="LITERAL">ROWS</TT>允许平均数或者设置返回函数返回的行的说明。
在选择最佳规划中通过优化器使用这些值。</P></LI><LI><P> 实现<TT CLASS="COMMAND">CREATE TABLE LIKE ... INCLUDING INDEXES</TT> (Trevor Hardcastle, Nikhil Sontakke, Neil)</P></LI><LI><P> 允许<TT CLASS="COMMAND">CREATE INDEX CONCURRENTLY</TT>忽略其它数据库中事务(Simon)</P></LI><LI><P> 添加<TT CLASS="COMMAND">ALTER VIEW ... RENAME TO</TT>和
<TT CLASS="COMMAND">ALTER SEQUENCE ... RENAME TO</TT> (David Fetter, Neil)</P><P> 之前这可能通过<TT CLASS="COMMAND">ALTER TABLE ... RENAME TO</TT>执行。</P></LI><LI><P> 使得<TT CLASS="COMMAND">CREATE/DROP/RENAME DATABASE</TT>短暂等待冲突后端在失败之前退出(Tom)</P><P> 这增加了这些命令成功的可能性。</P></LI><LI><P> 允许触发器和规则出于复制目的在使用配置参数组中无效(Jan)&#13;</P><P> 这允许复制系统禁用触发器并且重写规则作为无需直接修改系统目录组。
该操作通过<TT CLASS="COMMAND">ALTER TABLE</TT>和新参数<TT CLASS="VARNAME">session_replication_role</TT>被
控制。&#13;</P></LI><LI><P> 用户定义类型可以有类型修饰符(Teodor, Tom)</P><P> 这允许用户定义类型采取修饰符，像<TT CLASS="TYPE">ssnum(7)</TT>。
之前只有内置数据类型可以有修饰符。</P></LI></UL></DIV><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN129827">E.77.3.8. 实用命令</A></H3><P></P><UL><LI><P> 非超级用户数据库所有者可以添加可信任程序语言到缺省数据库中(Jeremy Drake)</P><P> 虽然这是相当安全的，一些管理员可能希望撤销该权限。
通过<TT CLASS="STRUCTNAME">pg_pltemplate</TT>.<TT CLASS="STRUCTFIELD">tmpldbacreate</TT>控制。</P></LI><LI><P> 允许会话的当前参数设置作为将来会话缺省使用(Tom)</P><P> 在<TT CLASS="COMMAND">CREATE/ALTER FUNCTION</TT>,
<TT CLASS="COMMAND">ALTER DATABASE</TT>，
或者<TT CLASS="COMMAND">ALTER ROLE</TT>中使用<TT CLASS="LITERAL">SET ... FROM CURRENT</TT>执行。</P></LI><LI><P> 实现新的命令<TT CLASS="COMMAND">DISCARD ALL</TT>,
<TT CLASS="COMMAND">DISCARD PLANS</TT>，
<TT CLASS="COMMAND">DISCARD TEMPORARY</TT>，
<TT CLASS="COMMAND">CLOSE ALL</TT>和
<TT CLASS="COMMAND">DEALLOCATE ALL</TT> (Marko Kreen, Neil)</P><P> 这些命令简化重置数据库会话到它的初始状态，并且特别有利于连接池软件。</P></LI><LI><P> 使得<TT CLASS="COMMAND">CLUSTER</TT> MVCC-安全(Heikki Linnakangas)</P><P> 之前，<TT CLASS="COMMAND">CLUSTER</TT>可能丢弃所有已提交为死的元组，
即使仍然有事务可以在MVCC可见规则下看到它们。 </P></LI><LI><P> 添加<TT CLASS="COMMAND">CLUSTER</TT>语法:
<TT CLASS="LITERAL">CLUSTER <TT CLASS="REPLACEABLE"><I>table</I></TT> USING <TT CLASS="REPLACEABLE"><I>index</I></TT></TT>
(Holger Schurig)</P><P> 仍然支持旧的<TT CLASS="COMMAND">CLUSTER</TT>语法，但是新形式更加合理。</P></LI><LI><P> 修复<TT CLASS="COMMAND">EXPLAIN</TT>以致于它可以更加准确显示复杂规划(Tom)</P><P> 参考子规划输出总是正确被显示，而不是为复杂情况使用<TT CLASS="LITERAL">?column<TT CLASS="REPLACEABLE"><I>N</I></TT>?</TT>。</P></LI><LI><P> 当删除用户的时候，限制报导信息量(Alvaro)</P><P> 之前，删除（或尝试删除）拥有很多对象的用户
可能导致列出所有这些对象的大的<TT CLASS="LITERAL">NOTICE</TT>或者
<TT CLASS="LITERAL">ERROR</TT>信息；
这造成一些客户端应用程序问题。信息长度是有限的，
但一个完整列表仍被发送到服务器日志。 </P></LI></UL></DIV><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN129874">E.77.3.9. 数据类型</A></H3><P></P><UL><LI><P> 支持SQL/XML标准，包含新的操作以及<TT CLASS="TYPE">XML</TT>数据类型(Nikolay Samokhvalov, Pavel Stehule, Peter)</P></LI><LI><P> 枚举数据类型(<TT CLASS="TYPE">ENUM</TT>) (Tom Dunstan)</P><P> 这个特性提供了方便支持小的，不变设置允许值的字段。
创建<TT CLASS="LITERAL">ENUM</TT>类型的例子是<TT CLASS="LITERAL">CREATE TYPE mood AS ENUM ('sad', 'ok', 'happy')</TT>。 </P></LI><LI><P> 通用唯一标识符(<TT CLASS="TYPE">UUID</TT>)数据类型(Gevik Babakhani, Neil)</P><P> 这紧密匹配<ACRONYM CLASS="ACRONYM">RFC</ACRONYM> 4122。</P></LI><LI><P> 加宽<TT CLASS="TYPE">MONEY</TT>数据类型到64位(D'Arcy Cain)</P><P> 这大大增加了支持<TT CLASS="TYPE">MONEY</TT>的范围</P></LI><LI><P> 修复<TT CLASS="TYPE">float4</TT>/<TT CLASS="TYPE">float8</TT>以不断地处理
<TT CLASS="LITERAL">Infinity</TT>和<TT CLASS="LITERAL">NAN</TT>(非数字)(Bruce) </P><P> 之前代码关于从溢出条件中识别<TT CLASS="LITERAL">Infinity</TT>是不一致的。 </P></LI><LI><P> 在<TT CLASS="TYPE">boolean</TT>值的输入中允许前导和尾随空格(Neil) </P></LI><LI><P> 阻止<TT CLASS="COMMAND">COPY</TT>使用数字和大小写字母作为分隔符(Tom)</P></LI></UL></DIV><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN129910">E.77.3.10. 函数</A></H3><P></P><UL><LI><P> 添加新规则表达式函数 <CODE CLASS="FUNCTION">regexp_matches()</CODE>,
<CODE CLASS="FUNCTION">regexp_split_to_array()</CODE>和
<CODE CLASS="FUNCTION">regexp_split_to_table()</CODE> (Jeremy Drake, Neil)</P><P> 这些函数提供了正则表达式子表达式的提取，并且允许使用POSIX正则表达式分裂字符串。</P></LI><LI><P> 为大对象截断添加<CODE CLASS="FUNCTION">lo_truncate()</CODE>(Kris Jurka)</P></LI><LI><P> 为<TT CLASS="TYPE">float8</TT>数据类型实现<CODE CLASS="FUNCTION">width_bucket()</CODE>(Neil)</P></LI><LI><P> 添加<CODE CLASS="FUNCTION">pg_stat_clear_snapshot()</CODE>用来丢弃当前事务中收集的统计快照(Tom)</P><P> 事务中统计的第一个请求需要事务期间不发生变化的统计快照。
此函数允许快照被丢弃，并且在接下来的统计查询中加载一个新的快照。
这对PL/pgSQL函数特别有用，
这些函数被限制在一个单一事务中。</P></LI><LI><P> 添加<TT CLASS="LITERAL">isodow</TT>选项<CODE CLASS="FUNCTION">EXTRACT()</CODE>和<CODE CLASS="FUNCTION">date_part()</CODE> (Bruce)</P><P> 这返回一周中一天，星期日为七。（<TT CLASS="LITERAL">dow</TT>返回星期日为零）</P></LI><LI><P> 为<CODE CLASS="FUNCTION">to_char()</CODE>，<CODE CLASS="FUNCTION">to_date()</CODE>和<CODE CLASS="FUNCTION">to_timestamp()</CODE>添加
<TT CLASS="LITERAL">ID</TT> (一周中ISO天)和<TT CLASS="LITERAL">IDDD</TT> (一年中ISO天)格式代码(Brendan Jurd)</P></LI><LI><P> 采用<CODE CLASS="FUNCTION">to_timestamp()</CODE>和<CODE CLASS="FUNCTION">to_date()</CODE>为潜在的可变宽度字段假设
<TT CLASS="LITERAL">TM</TT> (修剪)选项(Bruce)</P><P> 这匹配<SPAN CLASS="PRODUCTNAME">Oracle</SPAN>的操作。</P></LI><LI><P> 修复 <CODE CLASS="FUNCTION">to_date()</CODE>/<CODE CLASS="FUNCTION">to_timestamp()</CODE><TT CLASS="LITERAL">D</TT>
(一周中非ISO天)字段中偏移一个单位转换错误(Bruce)</P></LI><LI><P> <CODE CLASS="FUNCTION">setseed()</CODE>返回空，而不是无效整数值(Neil)</P></LI><LI><P> 为<TT CLASS="TYPE">NUMERIC</TT>添加哈希函数(Neil) </P><P> 这允许哈希索引和基于哈希规划用于<TT CLASS="TYPE">NUMERIC</TT> 列。</P></LI><LI><P> 提高<TT CLASS="LITERAL">LIKE</TT>/<TT CLASS="LITERAL">ILIKE</TT>的效率，尤其是
多字节字符集设置像UTF-8 (Andrew, Itagaki Takahiro) </P></LI><LI><P> 使用<CODE CLASS="FUNCTION">currtid()</CODE>函数需要目标表上<TT CLASS="LITERAL">SELECT</TT>权限(Tom) </P></LI><LI><P> 添加几个<CODE CLASS="FUNCTION">txid_*()</CODE>函数以查询活跃事务ID(Jan)</P><P> 这对于各种复制方法是有用的。 </P></LI></UL></DIV><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN129976">E.77.3.11. PL/pgSQL服务器端语言</A></H3><P></P><UL><LI><P> 添加可滚动游标支持，包含<TT CLASS="COMMAND">FETCH</TT>中方向控制(Pavel Stehule)</P></LI><LI><P> 允许<TT CLASS="LITERAL">IN</TT>作为PL/pgSQL的<TT CLASS="COMMAND">FETCH</TT>语句中
<TT CLASS="LITERAL">FROM</TT>的选择，与后端的<TT CLASS="COMMAND">FETCH</TT>命令一致(Pavel Stehule)</P></LI><LI><P> 添加<TT CLASS="COMMAND">MOVE</TT>到PL/pgSQL (Magnus, Pavel Stehule,Neil)</P></LI><LI><P> 实现<TT CLASS="COMMAND">RETURN QUERY</TT> (Pavel Stehule, Neil)</P><P> 这添加了想要返回查询结果的PL/pgSQL设置返回函数的便捷语法。
<TT CLASS="COMMAND">RETURN QUERY</TT>比环绕<TT CLASS="COMMAND">RETURN NEXT</TT>更容易而且更有效。</P></LI><LI><P> 允许函数参数名字符合函数的名字(Tom)</P><P> 比如<TT CLASS="LITERAL">myfunc.myvar</TT>。
在变量名可能匹配列名的查询中声明变量非常有用。
</P></LI><LI><P> 使得块标签变量正常执行(Tom)</P><P> 之前，外部级别块标签可能意外干扰内部级别记录或者行引用的识别。</P></LI><LI><P> 严格控制<TT CLASS="LITERAL">FOR</TT>循环<TT CLASS="LITERAL">STEP</TT>值的需求(Tom)</P><P> 防止非负<TT CLASS="LITERAL">STEP</TT>值，并且处理循环溢出。</P></LI><LI><P> 当报告语法错误位置的时候，提高精度(Tom)</P></LI></UL></DIV><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN130012">E.77.3.12. 其它服务器端语言</A></H3><P></P><UL><LI><P> 允许类型名参数到PL/Perl <CODE CLASS="FUNCTION">spi_prepare()</CODE>成为数据类型别名，
除了<TT CLASS="LITERAL">pg_type</TT>中发现的名字(Andrew) </P></LI><LI><P> 允许类型名参数到PL/Python <CODE CLASS="FUNCTION">plpy.prepare()</CODE>成为数据类型别名，
除了在<TT CLASS="LITERAL">pg_type</TT>中发现的名字(Andrew)</P></LI><LI><P> 允许类型名参数到PL/Tcl <CODE CLASS="FUNCTION">spi_prepare</CODE>成为数据类型别名，
除了在<TT CLASS="LITERAL">pg_type</TT>中发现的名字(Andrew)</P></LI><LI><P> 启动PL/PythonU在Python 2.5上编译(Marko Kreen)</P></LI><LI><P> 支持在兼容的Python版本中（Python 2.3和之后版本）真正的PL/Python布尔类型 (Marko Kreen)</P></LI><LI><P> 修复后台中线程启用<TT CLASS="FILENAME">libtcl</TT>产生大量线程的PL/Tcl问题
(Steve Marshall, Paul Bayer,Doug Knight)</P><P> 这导致了种种不愉快。</P></LI></UL></DIV><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN130035">E.77.3.13. <A HREF="app-psql.html"><SPAN CLASS="APPLICATION">psql</SPAN></A></A></H3><P></P><UL><LI><P> 分别列出<TT CLASS="LITERAL">\d</TT>输出中禁用触发器(Brendan Jurd)</P></LI><LI><P> 在<TT CLASS="LITERAL">\d</TT>模式中，总是逐字匹配<TT CLASS="LITERAL">$</TT>(Tom)</P></LI><LI><P> 显示<TT CLASS="LITERAL">\da</TT>输出中聚合返回类型(Greg Sabino Mullane)</P></LI><LI><P> 添加函数的波动状态到<TT CLASS="LITERAL">\df+</TT>的输出中(Neil)</P></LI><LI><P> 添加<TT CLASS="LITERAL">\prompt</TT>性能(Chad Wagner)</P></LI><LI><P> 添加<TT CLASS="LITERAL">\pset</TT>, <TT CLASS="LITERAL">\t</TT>和
<TT CLASS="LITERAL">\x</TT>用来声明<TT CLASS="LITERAL">on</TT>或者<TT CLASS="LITERAL">off</TT>，
而不仅仅是切换(Chad Wagner)</P></LI><LI><P> 添加<TT CLASS="LITERAL">\sleep</TT>能力(Jan)</P></LI><LI><P> 为<TT CLASS="LITERAL">\copy</TT>启用<TT CLASS="LITERAL">\timing</TT>输出(Andrew) </P></LI><LI><P> 提高Windows上<TT CLASS="LITERAL">\timing</TT>方法(Itagaki Takahiro) </P></LI><LI><P> 在每个反斜杠命令后冲洗<TT CLASS="LITERAL">\o</TT>输出(Tom)</P></LI><LI><P> 当读取<TT CLASS="LITERAL">-f</TT>输入文件的时候，正确地检测和报告错误(Peter)</P></LI><LI><P> 删除<TT CLASS="LITERAL">-u</TT>选项（该选项已经很长时间不使用）(Tom)</P></LI></UL></DIV><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN130082">E.77.3.14. <A HREF="app-pgdump.html"><SPAN CLASS="APPLICATION">pg_dump</SPAN></A></A></H3><P></P><UL><LI><P>
添加<TT CLASS="LITERAL">--tablespaces-only</TT>和<TT CLASS="LITERAL">--roles-only</TT>
选项到<SPAN CLASS="APPLICATION">pg_dumpall</SPAN> (Dave Page)</P></LI><LI><P> 添加输出文件选项到<SPAN CLASS="APPLICATION">pg_dumpall</SPAN> (Dave Page)</P><P> 这在Windows上有用，子<SPAN CLASS="APPLICATION">pg_dump</SPAN>进程输出重定向不执行。</P></LI><LI><P> 允许<SPAN CLASS="APPLICATION">pg_dumpall</SPAN>接受初始连接数据库名而不是缺省<TT CLASS="LITERAL">template1</TT> (Dave Page)</P></LI><LI><P> 在<TT CLASS="LITERAL">-n</TT>和<TT CLASS="LITERAL">-t</TT>切换中，总是逐字匹配<TT CLASS="LITERAL">$</TT>(Tom)</P></LI><LI><P> 当数据库中有成千上万对象时提高性能(Tom)</P></LI><LI><P> 删除<TT CLASS="LITERAL">-u</TT>选项（该选项已经很长时间不使用）(Tom)</P></LI></UL></DIV><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN130111">E.77.3.15. 其它客户端应用程序</A></H3><P></P><UL><LI><P> 在<SPAN CLASS="APPLICATION">initdb</SPAN>中，允许指定<TT CLASS="FILENAME">pg_xlog</TT>目录位置(Euler Taveira de Oliveira)</P></LI><LI><P> <SPAN CLASS="APPLICATION">pg_regress</SPAN>中支持的操作系统上启用服务器核心转储生成(Andrew)</P></LI><LI><P> 添加<TT CLASS="LITERAL">-t</TT> (超时)参数到<SPAN CLASS="APPLICATION">pg_ctl</SPAN>(Bruce)</P><P> 当等待服务器启动或者关闭的时候，这将控制<SPAN CLASS="APPLICATION">pg_ctl</SPAN>等待的多长时间。
之前超时被硬连线为60秒。</P></LI><LI><P> 添加<SPAN CLASS="APPLICATION">pg_ctl</SPAN>选项来控制服务器核心转储生成(Andrew) </P></LI><LI><P> 允许控制C取消<SPAN CLASS="APPLICATION">clusterdb</SPAN>，<SPAN CLASS="APPLICATION">reindexdb</SPAN>和<SPAN CLASS="APPLICATION">vacuumdb</SPAN>
(Itagaki Takahiro, Magnus)</P></LI><LI><P> 为<SPAN CLASS="APPLICATION">createdb</SPAN>，<SPAN CLASS="APPLICATION">createuser</SPAN>，<SPAN CLASS="APPLICATION">dropdb</SPAN>和
<SPAN CLASS="APPLICATION">dropuser</SPAN>抑制命令标签输出(Peter)</P><P> 忽略<TT CLASS="LITERAL">--quiet</TT>选项，并且在8.4中删除。
当在数据库上操作定位到标准输出上而非标准错误上时，促进信息，因为它们并不是真正错误。</P></LI></UL></DIV><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN130143">E.77.3.16. <A HREF="http://school.yunwei.edu/manual/PostgreSQL/libpq.html"><SPAN CLASS="APPLICATION">libpq</SPAN></A></A></H3><P></P><UL><LI><P> 如果它包含一个等号，那么解析<CODE CLASS="FUNCTION">PQsetdbLogin()</CODE>的<TT CLASS="LITERAL">dbName</TT>参数作为<TT CLASS="LITERAL">conninfo</TT>字符串(Andrew)</P><P> 这允许客户端程序中<TT CLASS="LITERAL">conninfo</TT>字符串的使用仍然使用<TT CLASS="LITERAL">PQsetdbLogin()</TT>。</P></LI><LI><P> 支持全局<ACRONYM CLASS="ACRONYM">SSL</ACRONYM>配置文件(Victor Wagner)</P></LI><LI><P> 添加环境变量<TT CLASS="VARNAME">PGSSLKEY</TT>支持<ACRONYM CLASS="ACRONYM">SSL</ACRONYM>硬件密钥(Victor Wagner)</P></LI><LI><P> 为大对象截断添加<CODE CLASS="FUNCTION">lo_truncate()</CODE> (Kris Jurka)</P></LI><LI><P> 如果服务器需要密码但是没有提供，那么添加<CODE CLASS="FUNCTION">PQconnectionNeedsPassword()</CODE>返回真(Joe Conway, Tom)</P><P> 如果失败连接尝试后返回真，那么客户端应用程序应该提示用户输入密码。
以往应用程序不得不检查一个特定的错误消息字符串
以决定是否需要密码；这种方法现在已经弃用。</P></LI><LI><P> 如果提供的密码已经被使用，那么添加<CODE CLASS="FUNCTION">PQconnectionUsedPassword()</CODE>返回真(Joe Conway, Tom)</P><P> 这在一些安全的地方是有用的，知道用户提供的密码是否有效非常重要。</P></LI></UL></DIV><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN130174">E.77.3.17. <A HREF="http://school.yunwei.edu/manual/PostgreSQL/ecpg.html"><SPAN CLASS="APPLICATION">ecpg</SPAN></A></A></H3><P></P><UL><LI><P> 使用V3 前端/后端协议(Michael) </P><P> 这添加了对服务器端预备语句的支持。</P></LI><LI><P> 使用本地支持，而不是Windows上pthreads(Magnus)</P></LI><LI><P> 提高ecpglib的线程安全(Itagaki Takahiro)</P></LI><LI><P> 使得ecpg库输出必要的API符号(Michael) </P></LI></UL></DIV><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN130188">E.77.3.18. <SPAN CLASS="APPLICATION">Windows</SPAN>端口</A></H3><P></P><UL><LI><P> 允许使用<SPAN CLASS="PRODUCTNAME">Microsoft Visual C++</SPAN>编译整个<SPAN CLASS="PRODUCTNAME">PostgreSQL</SPAN>发布(Magnus 和其他人)</P><P> 这允许基于Windows的开发人员可以使用熟悉的开发和调试工具。
用Visual C++制作的Windows可执行文件比用其他工具集制作的可能有更好的稳定性和性能。
已经删除仅仅客户端的Visual C++编译脚本。</P></LI><LI><P> 当有许多子进程的时候，大大减少postmaster的内存使用(Magnus)</P></LI><LI><P> 允许通过管理用户启动回归测试(Magnus)</P></LI><LI><P> 添加本地共享内存实现(Magnus)</P></LI></UL></DIV><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN130203">E.77.3.19. 服务器编程接口(<ACRONYM CLASS="ACRONYM">SPI</ACRONYM>)</A></H3><P></P><UL><LI><P> 在SPI中添加游标相关功能(Pavel Stehule)</P><P> 允许访问游标相关规划选项，并且添加<TT CLASS="COMMAND">FETCH</TT>/<TT CLASS="COMMAND">MOVE</TT>程序。</P></LI><LI><P> 允许通过<CODE CLASS="FUNCTION">SPI_execute</CODE>执行游标命令(Tom)</P><P> 宏<TT CLASS="LITERAL">SPI_ERROR_CURSOR</TT>仍然存在但永远不会被返回。 </P></LI><LI><P> SPI规划指针被声明为<TT CLASS="LITERAL">SPIPlanPtr</TT>而不是<TT CLASS="LITERAL">void *</TT> (Tom)</P><P> 这不会破坏应用程序代码，但是推荐切换来帮助捕获简单程序错误。</P></LI></UL></DIV><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN130222">E.77.3.20. 编译选项</A></H3><P></P><UL><LI><P> 添加<SPAN CLASS="APPLICATION">configure</SPAN>选项<TT CLASS="LITERAL">--enable-profiling</TT>
用来启动代码分析(使用<SPAN CLASS="APPLICATION">gcc</SPAN>执行)(Korry Douglas和Nikhil Sontakke)</P></LI><LI><P> 添加<SPAN CLASS="APPLICATION">configure</SPAN>选项<TT CLASS="LITERAL">--with-system-tzdata</TT>用来
使用操作系统的时区数据库(Peter)</P></LI><LI><P> 修复<ACRONYM CLASS="ACRONYM">PGXS</ACRONYM>，以致于扩展会不利于PostgreSQL的安装，其中
<SPAN CLASS="APPLICATION">pg_config</SPAN>程序没有首先出现在<TT CLASS="VARNAME">PATH</TT>中(Tom)</P></LI><LI><P> 当构建<ACRONYM CLASS="ACRONYM">SGML</ACRONYM>文档的时候，支持<TT CLASS="COMMAND">gmake draft</TT> (Bruce) </P><P> 除非使用<TT CLASS="LITERAL">draft</TT>，如果确保索引是最新的，那么文档建立将被重复。 </P></LI></UL></DIV><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN130245">E.77.3.21. 源代码</A></H3><P></P><UL><LI><P> 重命名宏<TT CLASS="LITERAL">DLLIMPORT</TT>到
<TT CLASS="LITERAL">PGDLLIMPORT</TT>以避免与包含（像Tcl）定义<TT CLASS="LITERAL">DLLIMPORT</TT>的第三方冲突 (Magnus)</P></LI><LI><P> 创建<SPAN CLASS="QUOTE">"操作符类"</SPAN>用来改善涉及交叉数据类型比较的查询规划(Tom)</P></LI><LI><P> 更新GIN <CODE CLASS="FUNCTION">extractQuery()</CODE> API允许发送信号没什么可以满足查询(Teodor)</P></LI><LI><P> 删除从<TT CLASS="FILENAME">postgres_ext.h</TT>到<TT CLASS="FILENAME">pg_config_manual.h</TT>的<TT CLASS="LITERAL">NAMEDATALEN</TT>定义(Peter)</P></LI><LI><P> 在所有平台上提供<CODE CLASS="FUNCTION">strlcpy()</CODE>和<CODE CLASS="FUNCTION">strlcat()</CODE>，
并且替换<CODE CLASS="FUNCTION">strncpy()</CODE>，<CODE CLASS="FUNCTION">strncat()</CODE>的易出错的用法，等(Peter)</P></LI><LI><P> 创建钩子以便使外部插件监听（或者甚至替换）规划器并且为假设情况创建规划(Gurjeet Singh, Tom)</P></LI><LI><P> 创建函数变量<TT CLASS="LITERAL">join_search_hook</TT>让插件覆盖规划器的连接搜索顺序部分(Julius Stroffek)</P></LI><LI><P> 添加<CODE CLASS="FUNCTION">tas()</CODE>支持Renesas的M32R处理器(Kazuhiro Inaoka)</P></LI><LI><P> <CODE CLASS="FUNCTION">quote_identifier()</CODE>和<SPAN CLASS="APPLICATION">pg_dump</SPAN>
不再引用依据语法未保留的关键字(Tom)</P></LI><LI><P> 改变<TT CLASS="TYPE">NUMERIC</TT>数据类型的磁盘上的表示，以致于<TT CLASS="STRUCTFIELD">sign_dscale</TT>词在权重之前(Tom)</P></LI><LI><P> 使用<ACRONYM CLASS="ACRONYM">SYSV</ACRONYM>信号而不是<ACRONYM CLASS="ACRONYM">SYSV</ACRONYM> &gt;= 6.0,即OS X 10.2及以上的POSIX(Chris Marcellino)</P></LI><LI><P> 添加<A HREF="http://school.yunwei.edu/manual/PostgreSQL/acronyms.html">acronym</A>和
<A HREF="creating-cluster.html#CREATING-CLUSTER-NFS">NFS</A>文档部分(Bruce)</P></LI><LI><P> "Postgres"作为"PostgreSQL"的公认别名(Peter) </P></LI><LI><P> 当服务器关闭的时候，添加关于避免数据库服务器欺骗的文档(Bruce)</P></LI></UL></DIV><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN130298">E.77.3.22. Contrib</A></H3><P></P><UL><LI><P> 移动<TT CLASS="FILENAME">contrib</TT> <TT CLASS="FILENAME">README</TT>内容到主<SPAN CLASS="PRODUCTNAME">PostgreSQL</SPAN>文档
(Albert Cervera i Areny)</P></LI><LI><P> 为低级别页面检查添加<TT CLASS="FILENAME">contrib/pageinspect</TT>(Simon, Heikki)</P></LI><LI><P> 为控制热备份操作添加<TT CLASS="FILENAME">contrib/pg_standby</TT>模块(Simon)</P></LI><LI><P> 为使用OSSP UUID库生成<TT CLASS="TYPE">UUID</TT>值添加<TT CLASS="FILENAME">contrib/uuid-ossp</TT>模块(Peter)</P><P> 使用<SPAN CLASS="APPLICATION">configure</SPAN><TT CLASS="LITERAL">--with-ossp-uuid</TT>激活，
这利用新的<TT CLASS="TYPE">UUID</TT>内置类型。 </P></LI><LI><P> 添加<TT CLASS="FILENAME">contrib/dict_int</TT>，<TT CLASS="FILENAME">contrib/dict_xsyn</TT>和
<TT CLASS="FILENAME">contrib/test_parser</TT>模块提供样本的附加文本搜索词典模板和解析器(Sergey Karpov) </P></LI><LI><P> 允许<SPAN CLASS="APPLICATION">contrib/pgbench</SPAN>设置填充因子(Pavan Deolasee)</P></LI><LI><P> 添加时间戳到<SPAN CLASS="APPLICATION">contrib/pgbench</SPAN> <TT CLASS="LITERAL">-l</TT>(Greg Smith)</P></LI><LI><P> 添加使用次数统计到<TT CLASS="FILENAME">contrib/pgbuffercache</TT> (Greg Smith)</P></LI><LI><P> 为<TT CLASS="FILENAME">contrib/hstore</TT>添加GIN支持(Teodor)</P></LI><LI><P> 为<TT CLASS="FILENAME">contrib/pg_trgm</TT>添加GIN支持(Guillaume Smet, Teodor)</P></LI><LI><P> 在<TT CLASS="FILENAME">contrib/start-scripts</TT>中更新OS/X启动脚本(Mark Cotner, David Fetter)</P></LI><LI><P> 限制<CODE CLASS="FUNCTION">pgrowlocks()</CODE>和
<CODE CLASS="FUNCTION">dblink_get_pkey()</CODE>到在目标表上拥有<TT CLASS="LITERAL">SELECT</TT>权限的用户中(Tom) </P></LI><LI><P> 限制<TT CLASS="FILENAME">contrib/pgstattuple</TT>函数到超级用户(Tom)</P></LI><LI><P> <TT CLASS="FILENAME">contrib/xml2</TT>过时了，计划在8.4中删除(Peter)</P><P> 核心PostgreSQL中新的XML支持取代该模块。</P></LI></UL></DIV></DIV></DIV><DIV CLASS="NAVFOOTER"><HR ALIGN="LEFT" WIDTH="100%"><TABLE SUMMARY="Footer navigation table" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0"><TR><TD WIDTH="33%" ALIGN="left" VALIGN="top"><A HREF="release-8-3-1.html" ACCESSKEY="P">&#19978;&#19968;&#39029;</A></TD><TD WIDTH="34%" ALIGN="center" VALIGN="top"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/index.html" ACCESSKEY="H">&#36215;&#22987;&#39029;</A></TD><TD WIDTH="33%" ALIGN="right" VALIGN="top"><A HREF="release-8-2-23.html" ACCESSKEY="N">&#19979;&#19968;&#39029;</A></TD></TR><TR><TD WIDTH="33%" ALIGN="left" VALIGN="top">发布8.3.1</TD><TD WIDTH="34%" ALIGN="center" VALIGN="top"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/release.html" ACCESSKEY="U">&#19978;&#19968;&#32423;</A></TD><TD WIDTH="33%" ALIGN="right" VALIGN="top">版本 8.2.23</TD></TR></TABLE></DIV></BODY></HTML>
