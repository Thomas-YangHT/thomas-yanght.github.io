<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML><HEAD><TITLE>日常数据库维护工作</TITLE><META NAME="GENERATOR" CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK REV="MADE" HREF="mailto:pgsql-docs@postgresql.org"><LINK REL="HOME" TITLE="PostgreSQL 9.3.1 中文手册" HREF="https://school.yunwei.edu/manual/PostgreSQL/index.html"><LINK REL="UP" TITLE="服务器管理" HREF="admin.html"><LINK REL="PREVIOUS" TITLE="字符集支持" HREF="https://school.yunwei.edu/manual/PostgreSQL/multibyte.html"><LINK REL="NEXT" TITLE="日常清理" HREF="https://school.yunwei.edu/manual/PostgreSQL/routine-vacuuming.html"><LINK REL="STYLESHEET" TYPE="text/css" HREF="stylesheet.css"><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8"><META NAME="creation" CONTENT="2015-07-11T14:00:17"></HEAD><BODY CLASS="CHAPTER">
<div style="text-align:right">
<a style="margin : 0px 0px 0px 10px;" href="https://github.com/postgres-cn/pgdoc-cn/issues/new" target="_blank" title="在Github上报告问题（请注明问题内容及所在章节）">问题报告</a>
<a style="margin : 0px 0px 0px 10px;" href="https://github.com/postgres-cn/pgdoc-cn/edit/master/postgresql/doc/src/sgml/maintenance.sgml" target="_blank" title="直接在Github上纠错本页面">纠错本页面</a>
</div>
<DIV CLASS="NAVHEADER"><TABLE SUMMARY="Header navigation table" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0"><TR><TH COLSPAN="5" ALIGN="center" VALIGN="bottom"><A HREF="https://school.yunwei.edu/manual/PostgreSQL/index.html">PostgreSQL 9.3.1 中文手册</A></TH></TR><TR><TD WIDTH="10%" ALIGN="left" VALIGN="top"><A TITLE="字符集支持" HREF="https://school.yunwei.edu/manual/PostgreSQL/multibyte.html" ACCESSKEY="P">&#19978;&#19968;&#39029;</A></TD><TD WIDTH="10%" ALIGN="left" VALIGN="top"><A HREF="admin.html" ACCESSKEY="U">&#19978;&#19968;&#32423;</A></TD><TD WIDTH="60%" ALIGN="center" VALIGN="bottom"></TD><TD WIDTH="20%" ALIGN="right" VALIGN="top"><A TITLE="日常清理" HREF="https://school.yunwei.edu/manual/PostgreSQL/routine-vacuuming.html" ACCESSKEY="N">&#19979;&#19968;&#39029;</A></TD></TR></TABLE><HR ALIGN="LEFT" WIDTH="100%"></DIV><DIV CLASS="CHAPTER"><H1><A NAME="MAINTENANCE"></A>&#31456; 23. 日常数据库维护工作</H1><DIV CLASS="TOC"><DL><DT><B>&#30446;&#24405;</B></DT><DT>23.1. <A HREF="https://school.yunwei.edu/manual/PostgreSQL/routine-vacuuming.html">日常清理</A></DT><DD><DL><DT>23.1.1. <A HREF="https://school.yunwei.edu/manual/PostgreSQL/routine-vacuuming.html#VACUUM-BASICS">清理基础</A></DT><DT>23.1.2. <A HREF="https://school.yunwei.edu/manual/PostgreSQL/routine-vacuuming.html#VACUUM-FOR-SPACE-RECOVERY">恢复磁盘空间</A></DT><DT>23.1.3. <A HREF="https://school.yunwei.edu/manual/PostgreSQL/routine-vacuuming.html#VACUUM-FOR-STATISTICS">更新规划器统计</A></DT><DT>23.1.4. <A HREF="https://school.yunwei.edu/manual/PostgreSQL/routine-vacuuming.html#VACUUM-FOR-VISIBILITY-MAP">更新可见视图</A></DT><DT>23.1.5. <A HREF="https://school.yunwei.edu/manual/PostgreSQL/routine-vacuuming.html#VACUUM-FOR-WRAPAROUND">避免事务ID重叠造成的问题</A></DT><DT>23.1.6. <A HREF="https://school.yunwei.edu/manual/PostgreSQL/routine-vacuuming.html#AUTOVACUUM">Autovacuum守护进程</A></DT></DL></DD><DT>23.2. <A HREF="https://school.yunwei.edu/manual/PostgreSQL/routine-reindex.html">经常重建索引</A></DT><DT>23.3. <A HREF="https://school.yunwei.edu/manual/PostgreSQL/logfile-maintenance.html">日志文件维护</A></DT></DL></DIV><P> 像许多其它数据库一样，<SPAN CLASS="PRODUCTNAME">PostgreSQL</SPAN>也需要周期性的运行某些任务以
实现性能优化。这里讨论的任务是<SPAN CLASS="emphasis"><I CLASS="EMPHASIS">必须</I></SPAN>经常重复的事情，
可以很容易的使用标准的工具(比如<SPAN CLASS="APPLICATION">cron</SPAN>脚本)或Windows
的<SPAN CLASS="APPLICATION">任务计划</SPAN>来完成。不过，
设置合适的脚本以及检查它们是否成功执行则是数据库管理员的责任。</P><P> 一件很明显的维护工作就是经常性地创建数据的备份拷贝。如果没有最近的备份，
那么你就没有从灾难中恢复的机会(磁盘坏、失火、误删表)。可以在<SPAN CLASS="PRODUCTNAME">PostgreSQL</SPAN>
里面使用的备份和恢复机制在<A HREF="backup.html">第 24 &#31456;</A>里面有比较详细的讨论。</P><P> 其它主要的维护工作包括周期性的<SPAN CLASS="QUOTE">"vacuuming"</SPAN>(清理)数据库。
这个工作我们在<A HREF="https://school.yunwei.edu/manual/PostgreSQL/routine-vacuuming.html">第 23.1 &#33410;</A>里讨论。与此紧密相关的是更新规划器使用的统计信息，
这个在<A HREF="https://school.yunwei.edu/manual/PostgreSQL/routine-vacuuming.html#VACUUM-FOR-STATISTICS">第 23.1.3 &#33410;</A>里讨论。</P><P> 其它需要周期性注意的东西是日志文件的管理。我们在<A HREF="https://school.yunwei.edu/manual/PostgreSQL/logfile-maintenance.html">第 23.3 &#33410;</A>里讨论了这个问题。</P><P> <A HREF="http://bucardo.org/wiki/Check_postgres" TARGET="_top"><SPAN CLASS="APPLICATION">check_postgres</SPAN></A>
可用于监测数据库健康并且报告不寻常的条件。<SPAN CLASS="APPLICATION">check_postgres</SPAN>结合Nagios和MRTG，
但也可以独立运行。</P><P> <SPAN CLASS="PRODUCTNAME">PostgreSQL</SPAN>和其它数据库产品比较起来是低维护量的。
但是，适当在这些任务上放一些注意将更加能够确保我们的愉快工作和获取对这个系统富有成效的经验。</P></DIV><DIV CLASS="NAVFOOTER"><HR ALIGN="LEFT" WIDTH="100%"><TABLE SUMMARY="Footer navigation table" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0"><TR><TD WIDTH="33%" ALIGN="left" VALIGN="top"><A HREF="https://school.yunwei.edu/manual/PostgreSQL/multibyte.html" ACCESSKEY="P">&#19978;&#19968;&#39029;</A></TD><TD WIDTH="34%" ALIGN="center" VALIGN="top"><A HREF="https://school.yunwei.edu/manual/PostgreSQL/index.html" ACCESSKEY="H">&#36215;&#22987;&#39029;</A></TD><TD WIDTH="33%" ALIGN="right" VALIGN="top"><A HREF="https://school.yunwei.edu/manual/PostgreSQL/routine-vacuuming.html" ACCESSKEY="N">&#19979;&#19968;&#39029;</A></TD></TR><TR><TD WIDTH="33%" ALIGN="left" VALIGN="top">字符集支持</TD><TD WIDTH="34%" ALIGN="center" VALIGN="top"><A HREF="admin.html" ACCESSKEY="U">&#19978;&#19968;&#32423;</A></TD><TD WIDTH="33%" ALIGN="right" VALIGN="top">日常清理</TD></TR></TABLE></DIV></BODY></HTML>
